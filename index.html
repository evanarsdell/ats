<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Multi-Job Applicant Tracking System</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- HEADER -->
  <header>
    <h1>Multi-Job ATS</h1>
    <div class="header-right">
      <!-- Big Blue Home Button -->
      <button id="homeBtn" class="home-btn">Home</button>

      <!-- Pipeline-only button: "Add Candidate Form" -->
      <button id="pipelineAddCandidateBtn" class="home-btn" style="display:none;">Add Candidate Form</button>

      <!-- Menu Dropdown -->
      <div class="dropdown">
        <button id="dropdownBtn" class="dropdown-btn">Menu ▼</button>
        <div id="dropdownContent" class="dropdown-content">
          <!-- We removed "Add Candidate Form" from here -->
          <button id="searchBtn">Search</button>
          <button id="viewArchivedCandidatesBtn">View Archived Candidates</button>
          <button id="viewArchivedJobsBtn">View Archived Jobs</button>
        </div>
      </div>
    </div>
  </header>

  <!-- SEARCH FIELD -->
  <div class="search-container" id="searchContainer" style="display: none;">
    <input type="text" id="searchInput" placeholder="Type a name to search..." />
  </div>

  <!-- JOBS VIEW (Home) -->
  <section id="jobsView">
    <h2>Jobs</h2>
    <div id="jobsList" class="jobs-list"></div>

    <!-- Two side-by-side forms (Add Job & Add Candidate) -->
    <div class="forms-row" style="display: flex; gap: 20px; margin-top: 30px;">
      <!-- Add Job Form -->
      <div class="form-container" style="flex: 1;">
        <h3>Add a New Job</h3>
        <form id="addJobForm">
          <label for="jobTitle">Job Title</label>
          <input type="text" id="jobTitle" required />
          
          <label for="jobManager">Hiring Manager</label>
          <input type="text" id="jobManager" required />

          <label for="jobLevel">Level</label>
          <input type="text" id="jobLevel" />

          <label for="jobCompRange">Comp Range</label>
          <input type="text" id="jobCompRange" />

          <label for="jobNotes">Notes</label>
          <textarea id="jobNotes"></textarea>

          <button type="submit">Add Job</button>
        </form>
      </div>

      <!-- Add Candidate Form (Home) -->
      <div class="form-container" style="flex: 1;">
        <h3>Add a New Candidate</h3>
        <form id="homeCandidateForm">
          <label for="homeCandidateName">Full Name</label>
          <input type="text" id="homeCandidateName" required />
          
          <label for="homeCandidateEmail">Email</label>
          <input type="email" id="homeCandidateEmail" required />

          <label for="homeCandidateJobSelect">Position (Job)</label>
          <select id="homeCandidateJobSelect" required></select>

          <label for="homeCandidateNotes">Notes</label>
          <textarea id="homeCandidateNotes"></textarea>

          <p><strong>Candidate Source:</strong></p>
          <div class="candidate-source-group">
            <label>
              <input type="radio" name="homeCandidateSource" value="referral" />
              Referral
            </label>
            <label>
              <input type="radio" name="homeCandidateSource" value="applied" checked />
              Applied
            </label>
            <label>
              <input type="radio" name="homeCandidateSource" value="sourced" />
              Sourced
            </label>
          </div>
          
          <button type="submit">Add Candidate</button>
        </form>
      </div>
    </div>
  </section>

  <!-- CANDIDATES VIEW (Pipeline) -->
  <section id="candidatesView" style="display:none;">
    <div id="jobHeader" class="job-header"></div>

    <!-- Stats bar -->
    <div id="statsBar" class="stats-bar"></div>

    <!-- Stages -->
    <div class="board">
      <div class="column" data-stage="Applied">
        <h2>Applied</h2>
        <div class="column-content" id="appliedList"></div>
      </div>
      <div class="column" data-stage="Phone Screen">
        <h2>Phone Screen</h2>
        <div class="column-content" id="phoneScreenList"></div>
      </div>
      <div class="column" data-stage="HM Screen">
        <h2>HM Screen</h2>
        <div class="column-content" id="hmScreenList"></div>
      </div>
      <div class="column" data-stage="On-site">
        <h2>On-site</h2>
        <div class="column-content" id="onsiteList"></div>
      </div>
      <div class="column" data-stage="Offer">
        <h2>Offer</h2>
        <div class="column-content" id="offerList"></div>
      </div>
      <div class="column" data-stage="Hired">
        <h2>Hired</h2>
        <div class="column-content" id="hiredList"></div>
      </div>
    </div>

    <!-- Pipeline Add Candidate Form (toggled by pipelineAddCandidateBtn) -->
    <div class="form-container" id="candidateFormContainer" style="display:none;">
      <h3>Add a New Candidate</h3>
      <form id="candidateForm">
        <label for="candidateName">Full Name</label>
        <input type="text" id="candidateName" required />
        
        <label for="candidateEmail">Email</label>
        <input type="email" id="candidateEmail" required />

        <label for="candidateJobSelect">Position (Job)</label>
        <select id="candidateJobSelect" required></select>

        <label for="candidateNotes">Notes</label>
        <textarea id="candidateNotes"></textarea>

        <p><strong>Candidate Source:</strong></p>
        <div class="candidate-source-group">
          <label>
            <input type="radio" name="candidateSource" value="referral" />
            Referral
          </label>
          <label>
            <input type="radio" name="candidateSource" value="applied" checked />
            Applied
          </label>
          <label>
            <input type="radio" name="candidateSource" value="sourced" />
            Sourced
          </label>
        </div>
        
        <button type="submit">Add Candidate</button>
      </form>
    </div>
  </section>

  <!-- ARCHIVED CANDIDATES VIEW -->
  <section id="archivedCandidatesView" style="display:none;">
    <h2>Archived Candidates</h2>
    <div id="archivedList" class="archived-list"></div>
    <button id="backToJobsFromArchiveCandidatesBtn" class="back-btn">← Back to Jobs</button>
  </section>

  <!-- ARCHIVED JOBS VIEW -->
  <section id="archivedJobsView" style="display:none;">
    <h2>Archived Jobs</h2>
    <div id="archivedJobsList" class="archived-list"></div>
    <button id="backToJobsFromArchiveJobsBtn" class="back-btn">← Back to Jobs</button>
  </section>

  <!-- Candidate Detail Modal -->
  <div id="viewCandidateModal" class="modal">
    <div class="modal-content">
      <span id="closeCandidateDetailModal" class="close">&times;</span>
      <h2>Candidate Details</h2>
      <div id="candidateDetailContent"></div>
    </div>
  </div>

  <!-- FEEDBACK MODAL (Now with read-only display if existing feedback) -->
  <div id="feedbackCandidateModal" class="modal">
    <div class="modal-content">
      <span id="closeFeedbackModal" class="close">&times;</span>
      <h2 id="feedbackModalTitle">Interview Feedback</h2>

      <!-- If there's existing feedback for the stage and readOnly = true,
           we show a read-only block. Otherwise, we show the form. -->
      <div id="feedbackReadOnlyContainer" style="display:none;">
        <div id="feedbackReadOnlyContent"></div>
        <button id="feedbackEditBtn" style="margin-top:10px;">Edit</button>
      </div>

      <form id="feedbackCandidateForm" style="display:none;">
        <input type="hidden" id="feedbackCandidateId" />
        <input type="hidden" id="feedbackStageValue" />

        <div id="nonOnsiteSection">
          <label for="feedbackRatingSelect">Rating</label>
          <select id="feedbackRatingSelect">
            <option value="strong_no">Strong No</option>
            <option value="no">No</option>
            <option value="yes">Yes</option>
            <option value="strong_yes">Strong Yes</option>
          </select>

          <label for="feedbackNotes">Detailed Feedback</label>
          <textarea id="feedbackNotes"></textarea>
        </div>

        <!-- If On-site is chosen, multiple interviewers. No general rating/notes. -->
        <div id="onsiteInterviewersSection" style="display:none;">
          <h4>On-site Interviewers</h4>
          <button type="button" id="addInterviewerBtn">+ Add Interviewer</button>
          <div id="onsiteInterviewersList"></div>
        </div>

        <button type="submit">Save Feedback</button>
      </form>
    </div>
  </div>

  <!-- The rest of your modals: EditCandidate, EditJob, TransferCandidate, ArchiveConfirm for candidate/job, etc. -->
  <div id="editCandidateModal" class="modal">
    <!-- ... -->
  </div>
  <div id="editJobModal" class="modal">
    <!-- ... -->
  </div>
  <div id="transferCandidateModal" class="modal">
    <!-- ... -->
  </div>
  <div id="archiveConfirmModal" class="modal">
    <!-- ... -->
  </div>
  <div id="archiveJobModal" class="modal">
    <!-- ... -->
  </div>

  <script src="app.js"></script>
</body>
</html>
